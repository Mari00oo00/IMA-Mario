# æœºå™¨å­¦ä¹ 

## æ¨¡å‹çš„è¯„ä¼°ä¸é€‰æ‹©

### **å¼•å…¥**

èƒŒæ™¯ï¼šåœ¨mä¸ªæ ·æœ¬ä¸­æœ‰aä¸ªæ ·æœ¬åˆ†ç±»é”™è¯¯

é”™è¯¯ç‡ï¼š$$E=a/m$$ï¼Œç²¾åº¦ï¼š$$1-a/m$$

**è®­ç»ƒè¯¯å·®ï¼ˆç»éªŒè¯¯å·®ï¼‰**

å­¦ä¹ å™¨åœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®

**æ³›åŒ–è¯¯å·®**

å­¦ä¹ å™¨åœ¨æ–°æ ·æœ¬ä¸Šçš„è¯¯å·®ã€‚æ³›åŒ–è¯¯å·®ä¸å¯é¿å…

**è¿‡æ‹Ÿåˆ**

æœºå™¨æŠŠè®­ç»ƒé›†å­¦ä¹ å¾—å¤ªå¥½ä»è€Œå¯¼è‡´æ³›åŒ–æ€§èƒ½ä¸‹é™

**æ¬ æ‹Ÿåˆ**

æœºå™¨å¯¹è®­ç»ƒæ ·æœ¬çš„ä¸€èˆ¬æ€§è´¨å°šæœªå­¦å¥½

**æ•°æ®é›†**

$$D=\{x_1,x_2,...,x_m \}$$è¡¨ç¤ºåŒ…å«mä¸ªç¤ºä¾‹çš„æ•°æ®é›†

$$x_i=(x_{i1};x_{i2},...;x_{id})$$æ˜¯dç»´æ ·æœ¬ç©ºé—´$$\chi$$çš„ä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­$$x_{ij}$$æ˜¯$$x_{i}$$åœ¨ç¬¬$$j$$ä¸ªå±æ€§ä¸Šçš„å–å€¼

**æ ·ä¾‹ä¸æ ‡è®°**

æ ·ä¾‹ï¼šæ‹¥æœ‰äº†æ ‡è®°ä¿¡æ¯çš„ç¤ºä¾‹ã€‚ä¸€èˆ¬åœ°ï¼Œç”¨$$(x_i,y_i)$$è¡¨ç¤ºç¬¬$$i$$ä¸ªæ ·ä¾‹ï¼Œå…¶ä¸­$$y_i \in \gamma$$æ˜¯ç¤ºä¾‹$$x_i$$çš„æ ‡è®°ï¼Œ$$\gamma$$æ˜¯æ‰€æœ‰æ ‡è®°çš„é›†åˆï¼Œäº¦ç§°â€œæ ‡è®°ç©ºé—´â€æˆ–â€œè¾“å‡ºç©ºé—´â€

**å­¦ä¹ ä»»åŠ¡**ï¼ˆè¯¦è§è¥¿ç“œä¹¦p3ï¼‰

æ ¹æ®æ¬²é¢„æµ‹çš„å€¼çš„ç±»å‹ï¼š

* åˆ†ç±»ï¼šæ¬²é¢„æµ‹çš„æ˜¯ç¦»æ•£å€¼
* å›å½’ï¼šæ¬²é¢„æµ‹çš„æ˜¯è¿ç»­å€¼

æ ¹æ®æ¶‰åŠåˆ°çš„ç±»åˆ«ï¼š

* â€œäºŒåˆ†ç±»â€ä»»åŠ¡ï¼šåªæ¶‰åŠä¸¤ä¸ªç±»åˆ«ã€‚é€šå¸¸ä¸€ä¸ªç±»ä¸ºâ€œæ­£ç±»â€ï¼Œå¦ä¸€ä¸ªä¸ºâ€œåç±»â€
* â€œå¤šåˆ†ç±»â€ä»»åŠ¡

æ ¹æ®è®­ç»ƒæ•°æ®æ˜¯å¦æ‹¥æœ‰æ ‡è®°ä¿¡æ¯ï¼š

* ç›‘ç£å­¦ä¹ ï¼ˆåˆ†ç±»å’Œå›å½’æ˜¯å…¶ä¸­çš„ä»£è¡¨ï¼‰
* æ— ç›‘ç£å­¦ä¹ ï¼ˆèšç±»æ˜¯å…¶ä¸­çš„ä»£è¡¨ï¼‰

### è¯„ä¼°æ–¹æ³•

1. é€šè¿‡æµ‹è¯•æ¥è¯„ä¼°å­¦ä¹ å™¨çš„æ³›åŒ–è¯¯å·®ï¼š

   * ä½¿ç”¨æµ‹è¯•é›†ï¼Œä½†æµ‹è¯•é›†ä¸è®­ç»ƒé›†çš„å…³ç³»åº”è¯¥å°½å¯èƒ½å°ã€‚

   åªæœ‰ä¸€ä¸ªæ•°æ®é›†æ—¶äº§ç”Ÿè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ–¹æ³•ï¼š

   1. ç•™å‡ºæ³•

   2. **äº¤å‰éªŒè¯æ³•ï¼ˆ$$k$$æŠ˜äº¤å‰éªŒè¯ï¼‰ï¼š**

      * [äº¤å‰éªŒè¯æ³•ä¸ç•™å‡ºæ³•åŠå…¶pythonå®ç°](https://blog.csdn.net/weixin_43216017/article/details/86692358?ops_request_misc=%7B%22request%5Fid%22%3A%22164282550316780271560942%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164282550316780271560942&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-86692358.first_rank_v2_pc_rank_v29&utm_term=ç•™ä¸€æ³•äº¤å‰éªŒè¯python&spm=1018.2226.3001.4187)

      * å°†æ•°æ®é›†$$D$$åˆ’åˆ†æˆ$$k$$ä¸ªå¤§å°ç›¸ä¼¼çš„äº’æ–¥å­é›†ï¼Œæ¯æ¬¡ç”¨$$k-1$$ä¸ªå­é›†çš„å¹¶é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œä½™ä¸‹çš„å­é›†æ˜¯æµ‹è¯•é›†ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œ$$k$$æ¬¡è®­ç»ƒä¸æµ‹è¯•ï¼Œæœ€ç»ˆè¿”å›çš„æ˜¯è¿™$$k$$ä¸ªæµ‹è¯•ç»“æœçš„å‡å€¼
      * ç•™ä¸€æ³•ï¼ˆæ•°æ®é›†è¾ƒå¤§æ—¶æ…ç”¨ï¼‰ï¼šä»¤$$k=æ ·æœ¬æ•°$$

   3. è‡ªåŠ©æ³•

   4. è°ƒå‚ä¸æœ€ç»ˆæ¨¡å‹

2. æ€§èƒ½åº¦é‡

   **å›å½’ä»»åŠ¡ä¸­æœ€å¸¸ç”¨å¾—æ€§èƒ½åº¦é‡ï¼šå‡æ–¹è¯¯å·®**ï¼ˆ$$MSE$$ï¼‰ï¼ˆè§è¥¿ç“œä¹¦29é¡µï¼‰

   $$E(f;D)=\frac {1}{m}\sum\limits_{i=1}^m (f(x_i)-y_i)^2$$

   **åˆ†ç±»ä»»åŠ¡ä¸­å¸¸ç”¨çš„æ€§èƒ½åº¦é‡ï¼š**

   * é”™è¯¯ç‡ä¸ç²¾åº¦

   * æŸ¥å‡†ç‡ã€æŸ¥å…¨ç‡ä¸F1

   * ROCä¸AUC

   * ä»£ä»·æ•æ„Ÿé”™è¯¯ç‡ä¸ä»£ä»·æ›²çº¿

3. æ¯”è¾ƒæ£€éªŒ

   * å‡è®¾æ£€éªŒ
   * äº¤å‰éªŒè¯tæ£€éªŒ
   * McNemaræ£€éªŒ
   * Friedmanæ£€éªŒä¸Nemenyiåç»­æ£€éªŒ

4. åå·®ä¸æ–¹å·®

## çº¿æ€§æ¨¡å‹

**åŸºæœ¬å½¢å¼**

$$f(x)=w^Tx+b$$ï¼Œå…¶ä¸­$$w=(w_1;w_2;...;w_d)$$ï¼Œ$$x=(x_1;x_2;...;x_d)$$ï¼ˆå³å«æœ‰dä¸ªå±æ€§ï¼‰ã€‚ç›®çš„æ˜¯å­¦å¾—$$w$$å’Œ$$b$$

### çº¿æ€§å›å½’

#### æ­£è§„æ–¹ç¨‹æ³•

**èƒ½ç›´æ¥æ±‚å‡ºè§£æè§£ï¼Œå› æ­¤ä¸ç”¨è®­ç»ƒå¤šæ¬¡ï¼**

æœ€å°äºŒä¹˜æ³•ï¼šåŸºäºå‡æ–¹è¯¯å·®æœ€å°åŒ–æ¥è¿›è¡Œæ¨¡å‹æ±‚è§£çš„æ–¹æ³•

**å‰ç½®è®¾å®šï¼š**

æ•°æ®é›†ï¼š$$D=\{ (x_1,y_1)ï¼Œ(x_2ï¼Œy_2),...,(x_n,y_n) \}$$

$$X=(x_1,x_2,...,x_n)^T=\begin{pmatrix} x_1^T \\ x_2^T \\ \vdots \\ x_n^T \end{pmatrix}$$ï¼Œ$$Y=\begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n\end{pmatrix} $$ï¼Œå…¶ä¸­$$x_i \in R^p$$ï¼Œ$$y_i \in R$$ï¼Œ$$w=\begin{pmatrix}   w_1 \\ w_2 \\ \vdots \\ w_n\end{pmatrix}$$

è®¾$$f(w)=w^Tx$$

æ¨å¯¼ï¼š
$$
\begin{aligned}
L(w)&=\sum\limits_{i=1}^m||w^Tx_i-y_i||^2 \qquad æœ€å°äºŒä¹˜æ³•\\&=\sum\limits_{i=1}^m(w^Tx_i-y_i)^2 \\&=[w^Tx_1-y_1 \quad w^Tx_2-y_2 \quad...\quad w^Tx_n-y_n] \begin{pmatrix} w^Tx_1-y_1 \\ w^Tx_2-y_2 \\ \vdots \\ w^Tx_n-y_n \end{pmatrix} \\&=([w^Tx_1 \quad w^Tx_2 \quad...\quad w^Tx_n]-[y_1 \quad y_2 \quad...\quad y_n]) \begin{pmatrix} w^Tx_1-y_1 \\ w^Tx_2-y_2 \\ \vdots \\ w^Tx_n-y_n \end{pmatrix} \\&=(w^T[x_1 \quad x_2 \quad...\quad x_n]-Y^T) \begin{pmatrix} w^Tx_1-y_1 \\ w^Tx_2-y_2 \\ \vdots \\ w^Tx_n-y_n \end{pmatrix} \\&=(w^TX^T-Y^T) \begin{pmatrix} w^Tx_1-y_1 \\ w^Tx_2-y_2 \\ \vdots \\ w^Tx_n-y_n \end{pmatrix} \\&=(w^TX^T-Y^T)(Xw-Y) \qquad ä»ç¬¬ä¸‰æ­¥å¯ä»¥çœ‹å‡ºå³è¾¹çš„çŸ©é˜µæ˜¯å·¦è¾¹çŸ©é˜µçš„é€†ç½® \\&=w^TX^TXw-w^TX^TY-Y^TXw+Y^TY \qquad é¡ºåºä¸èƒ½å†™é”™\\&=w^TX^TXw-2w^TX^TY+Y^TY \qquadä¸Šä¸€æ­¥çš„ä¸­é—´ä¸¤é¡¹äº’ä¸ºé€†ç½®ï¼Œå› æ­¤ç»“æœç›¸åŒï¼ˆéƒ½ä¸ºåŒä¸€ä¸ªæ•°ï¼‰ï¼Œå¯ä»¥åˆå¹¶
\end{aligned}
$$
æ‰€ä»¥ï¼Œ$$\hat{w}=arg\min L(w)$$.

> arg   æ˜¯å˜å…ƒï¼ˆå³è‡ªå˜é‡argumentï¼‰çš„è‹±æ–‡ç¼©å†™ã€‚
> arg min å°±æ˜¯ä½¿åé¢è¿™ä¸ªå¼å­è¾¾åˆ°æœ€å°å€¼æ—¶çš„å˜é‡çš„å–å€¼
> arg max å°±æ˜¯ä½¿åé¢è¿™ä¸ªå¼å­è¾¾åˆ°æœ€å¤§å€¼æ—¶çš„å˜é‡çš„å–å€¼

æ±‚æœ€å°å€¼çš„æ–¹æ³•æ˜¯å¯¹$$w$$æ±‚å¯¼ï¼Œå¹¶ä»¤å¼å­ä¸º0ï¼Œæ±‚å‡ºæ­¤æ—¶çš„$$w$$ï¼š
$$
\begin{aligned}
&\frac{\partial L(w)}{\partial w}=2X^TXw-2X^TY=0 \\&\therefore X^TXw=X^TY \\&\therefore w=(X^TX)^{-1}X^TY
\end{aligned}
$$

##### **ä»£ç å®ç°ï¼š**

**ä¸»è¦æ­¥éª¤ï¼š**å¯¼å…¥æ•°æ®é›†-æŸ¥çœ‹æ•°æ®é›†ç±»å‹-è½¬æ¢æ•°æ®é›†ä¸ºå¤šç»´çŸ©é˜µç±»å‹ï¼ˆå¦‚éœ€è½¬ç½®åˆ™è½¬ç½®ï¼‰-å®šä¹‰æ­£è§„æ–¹ç¨‹çš„å‡½æ•°å¹¶ç»æ­¤å°†$$w$$æ±‚å‡º-åˆ†åˆ«è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ä¸sklearnçš„æ¨¡å‹-æ¯”è¾ƒäºŒè€…æœ€ç»ˆçš„æŸå¤±å‡½æ•°å€¼

**sklearnå…¥é—¨ï¼š**

[éå¸¸è¯¦ç»†çš„sklearnä»‹ç»](https://blog.csdn.net/algorithmPro/article/details/103045824?ops_request_misc=%7B%22request%5Fid%22%3A%22164272427916780274136815%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164272427916780274136815&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103045824.first_rank_v2_pc_rank_v29&utm_term=sklearn&spm=1018.2226.3001.4187)

[æç®€Scikit-Learnå…¥é—¨](https://mp.weixin.qq.com/s?__biz=MzA4MjYwMTc5Nw==&mid=2648929856&idx=1&sn=0a6ce240f46bea7d74f2a850625de832&chksm=8794e46ab0e36d7c449579513e69fbbc957ac61eac10c6f863ed4a860debd3dca1ed0ba442c2&token=2004915986&lang=en_US#rd)

[æœºå™¨å­¦ä¹ ç¥å™¨ï¼šsklearnçš„å¿«é€Ÿä½¿ç”¨](https://juejin.cn/post/6844903632576446478)

**Linear Regressionä¸­çš„å‚æ•°åŠåŠŸèƒ½ï¼š**

[çº¿æ€§æ¨¡å‹ä¹‹Linear Regression_walk_power](https://blog.csdn.net/walk_power/article/details/82924363?ops_request_misc=%7B%22request%5Fid%22%3A%22164278046516780261964167%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164278046516780261964167&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-82924363.first_rank_v2_pc_rank_v29&utm_term=linearregression.fitå‡½æ•°&spm=1018.2226.3001.4187)

**ç³–å°¿ç—…æ•°æ®é›†ä»‹ç»ï¼š**

å®˜æ–¹ï¼ˆè‹±æ–‡ï¼‰ï¼š[7.1. Toy datasets â€” scikit-learn 1.0.2 documentation](https://scikit-learn.org/stable/datasets/toy_dataset.html#diabetes-dataset)

ä¸­æ–‡ï¼š[sklearnæ•°æ®é›†ä¹‹â€œç³–å°¿ç—…ç—…äººä½“æ£€æ•°æ®é›†â€](https://blog.csdn.net/Zee_Chao/article/details/95884401?ops_request_misc=%7B%22request%5Fid%22%3A%22164275178816780357286281%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164275178816780357286281&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-95884401.first_rank_v2_pc_rank_v29&utm_term=sklearnç³–å°¿ç—…æ•°æ®é›†&spm=1018.2226.3001.4187)

**çŸ©é˜µçš„è¿ç®—ï¼š**

[çŸ©é˜µçš„åˆ›å»ºä¸è¿ç®—](https://blog.csdn.net/m0_37759590/article/details/105160374?ops_request_misc=%7B%22request%5Fid%22%3A%22164274088716780271983059%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164274088716780271983059&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-105160374.first_rank_v2_pc_rank_v29&utm_term=python+mat()&spm=1018.2226.3001.4187)

**æŸå¤±å‡½æ•°ç›¸å…³çŸ¥è¯†ï¼š**

[å‡æ–¹è¯¯å·®ï¼Œlog losså’Œäº¤å‰ç†µ](https://blog.csdn.net/weixin_38410551/article/details/104973011?ops_request_misc=%7B%22request%5Fid%22%3A%22164277875816780271580985%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164277875816780271580985&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-104973011.first_rank_v2_pc_rank_v29&utm_term=å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°&spm=1018.2226.3001.4187)

**pytorchçš„è¿ç”¨ä¸torch-cpuçš„å®‰è£…ï¼š**

[æ·±åº¦å­¦ä¹ ç¯å¢ƒé…ç½®5â€”â€”windowsä¸‹çš„torch-cpu=1.2.0ç¯å¢ƒé…ç½®](https://blog.csdn.net/weixin_44791964/article/details/120655098)

`HTTPError: HTTP 000 CONNECTION FAILED`é”™è¯¯çš„è§£å†³åŠæ³•ï¼š[åœ¨ç»ˆç«¯é€šè¿‡condaæŒ‡ä»¤åˆ›å»ºè™šæ‹Ÿpythonç¯å¢ƒæ—¶ï¼Œå‡ºç°CondaHTTPError: HTTP 000 CONNECTION FAILEDç­‰é”™è¯¯](https://blog.csdn.net/kimpa0723/article/details/118912484?ops_request_misc=%7B%22request%5Fid%22%3A%22164286290616780255269742%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&request_id=164286290616780255269742&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-118912484.first_rank_v2_pc_rank_v29&utm_term=CondaHTTPError%3A&spm=1018.2226.3001.4187)

[PyTorchä¸­æ–‡æ–‡æ¡£ ](https://pytorch-cn.readthedocs.io/zh/latest/)

**`LeaveOneOut()`ç›¸å…³ï¼š**

å®˜æ–¹æ–‡æ¡£ï¼š[sklearn.model_selection.LeaveOneOut](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.LeaveOneOut.html?highlight=leaveoneout#sklearn.model_selection.LeaveOneOut)

**åœ¨çŸ©é˜µï¼ˆå¤šç»´æ•°ç»„ï¼‰å‰åŠ ä¸Šä¸€åˆ—ï¼š**

[np.hstack ç”¨æ³•](https://blog.csdn.net/G66565906/article/details/84142034?ops_request_misc=%7B%22request%5Fid%22%3A%22164292971316780269822279%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164292971316780269822279&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-84142034.first_rank_v2_pc_rank_v29&utm_term=np.hstack&spm=1018.2226.3001.4187)

[Pythonä¸­çš„numpy.ones()](https://blog.csdn.net/cunchi4221/article/details/107471968?ops_request_misc=%7B%22request%5Fid%22%3A%22164292924816781683974723%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164292924816781683974723&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-107471968.first_rank_v2_pc_rank_v29&utm_term=np.ones&spm=1018.2226.3001.4187)

**è®¾å®šä¸è¯´æ˜ï¼š**

è¯¥æ•°æ®é›†çš„ç±»å‹ä¸ºsklearn.utils.Bunchï¼ˆæœ¬è´¨æ˜¯å­—å…¸ï¼‰ï¼Œè¯¦è§[sklearn.utils.Bunchçš„å±æ€§](https://blog.csdn.net/lly1122334/article/details/88741971?ops_request_misc=%7B%22request%5Fid%22%3A%22164275423516780264093759%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164275423516780264093759&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-88741971.first_rank_v2_pc_rank_v29&utm_term=sklearn.utils.Bunch&spm=1018.2226.3001.4187)

ç”¨`data`æ¥è£…æ•°æ®é›†

sklearnä¸­çš„ç•™ä¸€æ³•å‡½æ•°çš„è¿ç”¨ï¼ˆåŸºæœ¬ä»¿ç…§å®˜æ–¹ç¤ºä¾‹æ‰“çš„ï¼‰ï¼š

*æ³¨ï¼š`split()`è¿”å›çš„åªæ˜¯åˆ†ç»„ä¹‹åçš„ç»„çš„ç´¢å¼•å€¼*

pythoné‡Œå¯¹å‘é‡è¿›è¡Œæ¬¡æ–¹çš„æ“ä½œæ˜¯å¯¹æ¯ä¸€ä¸ªå…ƒç´ å•ç‹¬è¿›è¡Œæ¬¡æ–¹ï¼Œè€Œä¸æ˜¯ç‚¹ä¹˜ã€‚

* æ±‚é¢„æµ‹å€¼ä»è€Œæ±‚$$MSE$$ç”¨çš„æ˜¯å‘é‡çš„æ–¹æ³•ç›´æ¥æ±‚å‡ºä¸€ä¸ªæ•´ä½“ï¼š`(np.array(X_train*wT.T-Y_train)**2).sum()/441`ï¼ˆä¸å…ˆè½¬æˆçŸ©é˜µå†å¹³æ–¹ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ˜¯éæ–¹é˜µï¼‰

æ³¨ï¼šè¯¥æ–¹æ³•ç”¨$$Xw$$è€Œä¸æ˜¯$$w^Tx$$

```python
loo = LeaveOneOut()
for train_index, test_index in loo.split(X):
    print("train_index:", train_index, "test_index:", test_index)
    X_train = X[train_index]
    Y_train = Y[train_index]
# è®­ç»ƒé›†çš„å½•å…¥
    X_test = X[test_index]
    Y_test = Y[test_index]
# æµ‹è¯•é›†çš„å½•å…¥
```

* éœ€åœ¨$$X$$çš„å‰é¢åŠ ä¸Šä¸€åˆ—$$x_0=1$$ï¼Œä¸ç„¶$$MSE$$çš„å€¼ä¼šå¾ˆå¤§

```python
X = data.data
X = np.hstack((np.ones((len(X), 1)), X))
X = np.mat(X)
```

* sklearnä¸­çš„çº¿æ€§å›å½’å‡½æ•°çš„è°ƒç”¨ï¼š

```python
lr_fun = LinearRegression()
lr_fun.fit(np.array(X_train), np.array(Y_train))
# Xä¸Yçš„è¾“å…¥
y_pre_sk = lr_fun.predict(np.array(X_train))
print("sk_loss:", (np.array(y_pre_sk-Y_train)**2).sum()/441)
```

å…¨éƒ¨ä»£ç ï¼š

```python
import numpy as np
from sklearn import datasets
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import LeaveOneOut
# å¯¼å…¥ç•™ä¸€æ³•å‡½æ•°
data = datasets.load_diabetes()
# å¯¼å…¥ç³–å°¿ç—…æ•°æ®é›†


def linear_regression(X, Y):
    """
    æ±‚wT
    """
    XT = X.T
    XTX = XT*X
    w = XTX.I*XT*Y
    return w


X = data.data
X = np.hstack((np.ones((len(X), 1)), X))
X = np.mat(X)
# è¿™é‡Œä¸ç”¨è½¬ç½®

Y = data.target
Y = np.mat(Y).T

loo = LeaveOneOut()
for train_index, test_index in loo.split(X):
    X_train = X[train_index]
    Y_train = Y[train_index]
    X_test = X[test_index]
    Y_test = Y[test_index]

w = linear_regression(X_train, Y_train)
print("loss:", (np.array(X_train*w-Y_train)**2).sum()/441)

lr_fun = LinearRegression()
lr_fun.fit(np.array(X_train), np.array(Y_train))
# Xä¸Yçš„è¾“å…¥
y_pre_sk = lr_fun.predict(np.array(X_train))
print("sk_loss:", (np.array(y_pre_sk-Y_train)**2).sum()/441)
```

#### æ¢¯åº¦ä¸‹é™æ³•

[ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™æ³•ï¼Ÿ](https://www.zhihu.com/question/305638940/answer/1639782992)

[æ¢¯åº¦ä¸‹é™æ³•åŠå…¶Pythonå®ç°](https://blog.csdn.net/yhao2014/article/details/51554910?ops_request_misc=&request_id=&biz_id=102&utm_term=æ¢¯åº¦ä¸‹é™æ³•pythonå®ç°&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-51554910.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187)

[æœºå™¨å­¦ä¹ ä¹‹æ¢¯åº¦ä¸‹é™ç®—æ³•(pythonå®ç°)](https://blog.csdn.net/weixin_43872709/article/details/108938376?ops_request_misc=%7B%22request%5Fid%22%3A%22164301014616780264092110%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164301014616780264092110&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108938376.first_rank_v2_pc_rank_v29&utm_term=æ¢¯åº¦ä¸‹é™æ³•pythonå®ç°&spm=1018.2226.3001.4187)

**å…¬å¼ï¼š**$$\theta_j:=\theta_j-\alpha \frac{\partial J(\theta_0,\theta_1...\theta_n)}{\partial \theta_j}$$ï¼Œå…¶ä¸­$$j=0,1,...,n$$ï¼›$$\alpha$$è¢«ç§°ä¸ºå­¦ä¹ ç‡ï¼Œæ˜¯ä¸ªæ­£æ•°ï¼›$$:=$$æ˜¯èµ‹å€¼çš„æ„æ€ï¼›è¦åŒæ—¶æ›´æ–°$$\theta_0,\theta_1,...,\theta_n$$çš„åæ ‡

**åŸç†ï¼š**ä¸€æ­¥ä¸€æ­¥é€¼è¿‘å±€éƒ¨æœ€ä¼˜è§£ï¼ˆå¯¼æ•°ä¸º0çš„ç‚¹ã€‚çº¿æ€§æ–¹ç¨‹åªæœ‰1ä¸ªå…¨å±€æœ€ä¼˜è§£ï¼‰ï¼Œä¸”æ­¥é•¿éšç€è¿­ä»£çš„æ¬¡æ•°å¢åŠ è€Œé™ä½ã€‚

##### ç”¨æ¢¯åº¦ä¸‹é™æ³•å®ç°çº¿æ€§å›å½’

**å‰ç½®è®¾å®šäºè¯´æ˜ï¼š**

æ•°æ®é›†æœ‰$$m$$ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰nä¸ªç‰¹å¾

**å‡è®¾å‡½æ•°ï¼ˆå³è¦æ±‚çš„å‡½æ•°ï¼‰ï¼š**$$h_\theta(x)=\theta^Tx=\theta_0+\theta_1x_1+\cdots+\theta_nx_n=\sum\limits_{i=0}^n \theta_i x_i$$ï¼Œå…¶ä¸­$$x^{(i)}_j$$æ„ä¸ºç¬¬$$i$$ä¸ªæ ·æœ¬çš„ç¬¬$$j$$ä¸ªç‰¹å¾ï¼Œè§„å®š$$x^0_j=1$$ï¼ˆå³åœ¨çŸ©é˜µå‰æ·»åŠ ä¸€åˆ—æ•°å­—1ï¼‰

**ä»£ä»·å‡½æ•°ï¼ˆæŸå¤±å‡½æ•°ï¼‰ï¼š**$$J(\theta_0,\theta_1,\cdots,\theta_n)=J(\theta)=\frac{1}{2m} \sum\limits_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})^2=\frac{1}{2m}(X\theta-Y)^2å‘é‡æ¯ä¸ªå€¼ç›¸åŠ $$ï¼ˆè¿™é‡Œä¹˜1/2æ˜¯ä¸ºäº†ä¸‹ä¸€æ­¥æ±‚åå¯¼æ•°æ—¶å¼å­æ›´ç¾è§‚ï¼‰

**æ‰€ä»¥**$$\theta_j:=\theta_j-\alpha \frac{\partial J(\theta_0,\theta_1...\theta_n)}{\partial \theta_j}=\theta_j-\alpha \cdot \frac{1}{m}\sum\limits_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})x^{(i)}_j$$ï¼ˆå…·ä½“è¿‡ç¨‹å¾ˆå®¹æ˜“æ¨å¯¼å‡ºæ¥ï¼‰

**æŠŠ$$\theta_j$$ä¸€æ¬¡æ€§å…¨éƒ¨æ±‚å‡ºæ¥ï¼ˆå³å†™æˆå‘é‡å½¢å¼$$\theta$$ï¼‰ï¼š**

è§„å®šï¼š$$\theta$$ä¸º$$(n+1)\cdot1$$çš„åˆ—å‘é‡ï¼Œ$$X$$ä¸º$$m(n+1)$$çš„çŸ©é˜µï¼Œ$$Y$$ä¸º$$m\cdot1$$çš„åˆ—å‘é‡
$$
\begin{aligned}
\theta:=\theta-\frac{\alpha}{m}((X \theta-Y)^T \cdot X)^T=\theta- \frac{\alpha}{m}X^T(X \theta-Y)
\end{aligned}
$$
æ¨å¯¼è¿‡ç¨‹ï¼š
$$
\begin{aligned}
&\because \thetaä¸º(n+1)\cdot1çš„åˆ—å‘é‡\\&
\therefore\frac{\alpha}{m}åº”è¯¥ä¹˜ä»¥ä¸€ä¸ªåŒæ ·ä¸º(n+1)\cdot1çš„åˆ—å‘é‡\\&
\thereforeå†çœ‹å³è¾¹ï¼Œè¦æŠŠ\sum\limits_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})x^{(i)}_jå˜æˆä¸€ä¸ª(n+1)\cdot1çš„åˆ—å‘é‡æˆ–1\cdot(n+1)çš„è¡Œå‘é‡\\&
åˆ\becauseé€šè¿‡è§‚å¯Ÿå¯å¾—x^{(i)}_jä¹˜(h_\theta(x^{(i)})-y^{(i)})æ—¶å¯çœ‹æˆä¸€ä¸ªåˆ—å‘é‡ä¹˜(h_\theta(x^{(i)})-y^{(i)})ï¼Œä¸”ç»“æœè¦ä¸ºä¸Šä¸€æ­¥æ‰€è¯´\\&
\therefore\sum\limits_{i=1}^m(h_\theta(x^{(i)})-y^{(i)})x^{(i)}_jçš„ç»“æœå¯ä»¥çœ‹æˆ(h_\theta(x^{(i)})-y^{(i)})\cdot X\\&
åˆ\because Xçš„è¡Œæ•°ä¸ºm\\&
\therefore(h_\theta(x^{(i)})-y^{(i)})è¦å†™æˆåˆ—æ•°ä¸ºmçš„è¡Œå‘é‡\\&
åˆ\because Yä¸ºm\cdot 1çš„åˆ—å‘é‡\\&
\therefore h_\theta(x^{(i)})å¯å†™æˆX\theta\\&
\therefore (X\cdot \theta -Y)ä¸º(1\cdot m)çš„è¡Œå‘é‡\\&
\therefore (X \theta-Y)^T \cdot Xä¸º1\cdot (n+1)çš„è¡Œå‘é‡\\&
\thereforeæœ€åè½¬ç½®ä¸€ä¸‹å³å¯
\end{aligned}
$$
ä¹Ÿå¯ä»¥å¯¹ä»£ä»·å‡½æ•°æ±‚å¯¼åå†ç®—ï¼ˆæ³¨æ„å¥½å˜æ¢sizeå°±è¡Œï¼‰

<img src="http://mari0.oss-cn-guangzhou.aliyuncs.com/img/image-20220124224813833.png" alt="image-20220124224813833" style="zoom: 80%;" />

###### ä»£ç å®ç°ï¼š

**è¿‡ç¨‹ï¼š**å–å‡º$$X$$ä¸$$Y$$ï¼Œå¹¶å¯¹$$X$$å¢åŠ ä¸€åˆ—æ•°å­—1-è®¾ç½®å­¦ä¹ ç‡ä¸è®­ç»ƒæ¬¡æ•°ï¼ŒæŠŠ$$\theta$$å…¨è®¾ç½®ä¸º0-è¿­ä»£å¹¶æ±‚loss-ä¸æ–­è°ƒå‚ä½¿losså°½å¯èƒ½å°

**è®¾å®šä¸ç›¸å…³è¯´æ˜ï¼š**

è§„å®š$$\theta$$ä¸€å¼€å§‹å…¨ä¸º0ï¼Œä¸”ä¸ºåˆ—å‘é‡ï¼›å­¦ä¹ ç‡ä¸º1ï¼Œæ¬¡æ•°50000æ¬¡

```python
theta = np.zeros(11).T
alpha = 1
times = 50000
```

å¾—åˆ°æ¢¯åº¦çš„å‡½æ•°

```python
def get_theta(X, Y, theta, alpha, m):
    theta = theta-(alpha/m)*(X.T*(X*theta-Y))
    return theta
```

æŸå¤±å‡½æ•°

```python
def get_loss(X, Y, theta):
    loss = (1/(2*len(X)))*(np.array((X*theta-Y))**2)
    return loss.sum()
```

è¿­ä»£

```python
for i in range(times):
    theta = get_theta(X, Y, theta, alpha, len(X))
    loss = get_loss(X, Y, theta)
    print(loss)
```

å…¨éƒ¨ä»£ç ï¼š

```python
import numpy as np
from sklearn import datasets
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import LeaveOneOut
# å¯¼å…¥ç•™ä¸€æ³•å‡½æ•°
data = datasets.load_diabetes()
# å¯¼å…¥ç³–å°¿ç—…æ•°æ®é›†

X = data.data
X = np.hstack((np.ones((len(X), 1)), X))
X = np.mat(X)
# è¿™é‡Œä¸ç”¨è½¬ç½®

Y = data.target
Y = np.mat(Y).T

theta = np.zeros(11)
theta = np.mat(theta).T

alpha = 1
times = 50000


def get_loss(X, Y, theta):
    loss = (1/(2*len(X)))*(np.array((X*theta-Y))**2)
    return loss.sum()


def get_theta(X, Y, theta, alpha, m):
    theta = theta-(alpha/m)*(X.T*(X*theta-Y))
    return theta


for i in range(times):
    theta = get_theta(X, Y, theta, alpha, len(X))
    loss = get_loss(X, Y, theta)
    print(loss)
```

### é€»è¾‘å›å½’

[ç”¨äººè¯è®²æ˜ç™½é€»è¾‘å›å½’Logistic regression](https://zhuanlan.zhihu.com/p/139122386)

[ã€æœºå™¨å­¦ä¹ ã€‘é€»è¾‘å›å½’ï¼ˆéå¸¸è¯¦ç»†ï¼‰](https://zhuanlan.zhihu.com/p/74874291)

#### å¼•å…¥ï¼ˆä»¥äºŒåˆ†ç±»ä»»åŠ¡ä¸ºä¾‹ï¼‰

**å› å˜é‡ï¼š**åˆ†ç±»å‹ï¼Œä¸€èˆ¬å–0æˆ–1ã€‚å› æ­¤ï¼Œ$$y=w^Tx$$ä¸é€‚ç”¨ã€‚

**Sigmoidå‡½æ•°ï¼ˆLogisticå‡½æ•°ï¼‰ï¼š**

* åŸå§‹å…¬å¼ï¼š$$S(x)=\frac{1}{1+e^{-x}}$$ï¼Œå˜ä¸ºå¤šå…ƒå‡½æ•°åï¼š$$P(Y=1)=\frac{1}{1+e^{-X\theta}}$$
* æ„ä¹‰ï¼šå°†å› å˜é‡æ˜ å°„åœ¨$$(0,1)$$ä¹‹é—´
* å›¾åƒï¼š![image-20220125154313415](http://mari0.oss-cn-guangzhou.aliyuncs.com/img/image-20220125154313415.png)

**ä¼¼ç„¶å‡½æ•°ä¸æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ï¼š**

* ä¼¼ç„¶å‡½æ•°ï¼š

  [ä¼¼ç„¶ï¼ˆlikelihoodï¼‰å’Œæ¦‚ç‡ï¼ˆprobabilityï¼‰çš„åŒºåˆ«ä¸è”ç³»](https://blog.csdn.net/songyu0120/article/details/85059149)

  ä¼¼ç„¶å‡½æ•°ï¼š$$L(\theta|x)$$ï¼Œæ¦‚ç‡ï¼š$$P(x|\theta)$$ï¼ŒäºŒè€…çš„å€¼ç›¸ç­‰ã€‚é€šè¿‡æ•°æ®æ±‚$$\theta$$çš„è¿‡ç¨‹å³è®­ç»ƒé˜¶æ®µã€‚

* æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ï¼š

  è®¾å®šï¼šæœ‰$$N$$ä¸ªæ ·æœ¬

  1. å•ä¸ªäº‹ä»¶æ­£ç¡®çš„æ¦‚ç‡ï¼š$$P(y|x,\theta)=p(y=1|x,\theta)^{y}\cdot p(y=0|x,\theta)^{1-y}$$
  2. å¤šä¸ªäº‹ä»¶æ­£ç¡®çš„æ¦‚ç‡ï¼š$$P(Y|X,\theta)=\prod \limits_{i=1}^N p(y^{(i)}|x^{(i)},\theta)$$

  æ ¹æ®$$L(\theta|x)=P(x|\theta)$$ï¼Œå¯å¾—æå¤§ä¼¼ç„¶ä¼°è®¡å‡½æ•°ä¸ºï¼š

  $$\hat{\theta}=arg\ max\ P(Y|X,\theta)$$

  ä¸ºäº†æ–¹ä¾¿è¿ç®—ï¼Œè¦æŠŠè¿ä¹˜æ¢æˆè¿åŠ ï¼Œå› æ­¤è¦å–å¯¹æ•°è¿ç®—ã€‚å…·ä½“æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š
  $$
  \begin{aligned}
  \hat{\theta}&=arg\ max\ P(Y|X,\theta) \\&=arg\ max\ log(P(Y|X,\theta)) \\&=arg\ max\ log(\prod \limits_{i=1}^N p(y^{(i)}|x^{(i)},\theta)) \quad äº‹ä»¶ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥ç”¨ä¹˜æ³• \\&=arg\ max\ log(\prod \limits_{i=1}^N p(y^{(i)}=1|x^{(i)},\theta)^{y^{(i)}}\cdot p(y^{(i)}=0|x^{(i)},\theta)^{1-y^{(i)}}) \\&=arg\ max\ log(\prod \limits_{i=1}^N p(y^{(i)}=1|x^{(i)},\theta)^{y^{(i)}}\prod \limits_{i=1}^N p(y^{(i)}=0|x^{(i)},\theta)^{1-y^{(i)}}) \\&=arg\ max\ \sum \limits_{i=1}^N [ log(p(y^{(i)}=1|x^{(i)},\theta)^{y^{(i)}}+log\ (p(y^{(i)}=0|x^{(i)},\theta)^{1-y^{(i)}}))] \\&=arg\ max\ \sum \limits_{i=1}^N [log(\frac{1}{1+e^{-\theta ^Tx^{(i)}}})^{y^{(i)}}+ log(\frac {e^{-\theta ^Tx^{(i)}}}{1+e^{-\theta ^Tx^{(i)}}})^{1-y^{(i)}}] \\&=arg\ max\ \sum \limits_{i=1}^N [(y^{(i)})log(\frac{1}{1+e^{-\theta ^Tx^{(i)}}})+(1-y^{(i)})log(\frac {e^{-\theta ^Tx^{(i)}}}{1+e^{-\theta ^Tx^{(i)}}})]
  \end{aligned}
  $$
  

**æŸå¤±å‡½æ•°ï¼š**åœ¨é€»è¾‘å›å½’æ¨¡å‹ä¸­ï¼Œ**æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°**å’Œ**æœ€å°åŒ–æŸå¤±å‡½æ•°**å®é™…ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œå› æ­¤æŸå¤±å‡½æ•°ä¸ºï¼ˆæœ€åå¯ä»¥é™¤ä»¥æ ·æœ¬æ•°ï¼‰ï¼š

$$J(\theta)=-log\ L(\theta)=-\sum \limits_{i=1}^N [(y^{(i)})log(\frac{1}{1+e^{-\theta ^Tx^{(i)}}})+(1-y^{(i)})log(\frac {e^{-\theta ^Tx^{(i)}}}{1+e^{-\theta ^Tx^{(i)}}})]$$

**æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£$$\theta$$ï¼š**

ä»ç®€å•å¼€å§‹ï¼Œå¯¹sigmoidå‡½æ•°$$S(x)=\frac{1}{1+e^{-x}}$$æ±‚å¯¼ï¼š$$S'(x)=\frac{e^{-x}}{(1+e^{-x})^2}$$ï¼Œé€šè¿‡è§‚å¯Ÿå¾—$$S'(x)=S(x)\cdot (1-S(x))$$

æŒ‰ç…§ä»¥å¾€çš„ä¹ æƒ¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚æŸå¤±å‡½æ•°çš„æœ€å°å€¼ã€‚

ä»¤$$f(x^{(i)},\theta)=log(\frac{1}{1+e^{-\theta ^Tx^{(i)}}})$$,$$g(y^{(i)},x^{(i)},\theta)=[(y^{(i)})log(\frac{1}{1+e^{-\theta ^Tx^{(i)}}})+(1-y^{(i)})log(\frac {e^{-\theta ^Tx^{(i)}}}{1+e^{-\theta ^Tx^{(i)}}})]$$ï¼Œ

å› æ­¤$$J(\theta)=-\sum \limits_{i=1}^N [(y^{(i)})log(f(x^{(i)}ï¼Œ\theta))+(1-y^{(i)})log(1-f(x^{(i)}ï¼Œ\theta)] =-\sum \limits_{i=1}^N g(y^{(i)},x^{(i)},\theta)$$

ä¸‹é¢å¯¹$$g(y^{(i)},x^{(i)},\theta)$$æ±‚$$\theta_j$$çš„åå¯¼ï¼š
$$
\begin{aligned}
&\because \frac{\partial f(x^{(i)},\theta)}{\partial\theta_j}=f(x^{(i)},\theta)\cdot (1-f(x^{(i)},\theta))\cdot x^{(i)}_j\\&
\therefore \frac{\partial g(y^{(i)},x^{(i)},\theta)}{\partial \theta_j}=y^{(i)}\frac{1}{f(x^{(i)},\theta)}\frac{\partial f(x^{(i)},\theta)}{\partial \theta_j}-(1-y^{(i)})\frac{1}{1-f(x^{(i)},\theta)}\frac{\partial f(x^{(i)},\theta)}{\partial \theta_j}\\&
=(\frac{y^{(i)}}{f(x^{(i)},\theta)}-\frac{1-y^{(i)}}{1-f(x^{(i)},\theta)})\cdot \frac{\partial f(x^{(i)},\theta)}{\partial \theta_j}\\&
=(\frac{y^{(i)}}{f(x^{(i)},\theta)}-\frac{1-y^{(i)}}{1-f(x^{(i)},\theta)})\cdot f(x^{(i)},\theta)\cdot (1-f(x^{(i)},\theta))\cdot x^{(i)}_j\\&
=[y^{(i)}(1-f(x^{(i)},\theta))-(1-y^{(i)})f(x^{(i)},\theta)]\cdot x^{(i)}_j\\&
=(y-f(x^{(i)},\theta))\cdot x^{(i)}_j
\end{aligned}
$$
å› æ­¤ï¼Œ$$\frac{\partial J(\theta)}{\partial \theta_j}=-\sum \limits_{i=1}^N (y-f(x^{(i)},\theta))\cdot x^{(i)}_j=\sum \limits_{i=1}^N (\frac{1}{1+e^{-\theta^T x^{(i)}}}-y^{(i)})\cdot x^{(i)}_j$$

æ ¹æ®$$\theta_j:=\theta_j-\alpha \frac{\partial J(\theta_0,\theta_1...\theta_n)}{\partial \theta_j}=\theta_j-\alpha \cdot \sum \limits_{i=1}^N (\frac{1}{1+e^{-\theta^T x^{(i)}}}-y^{(i)})\cdot x^{(i)}_j$$

å’Œ$$\theta:=\theta-\frac{\alpha}{N}((X \theta-Y)^T \cdot X)^T=\theta- \frac{\alpha}{N}X^T(X \theta-Y)$$ä¸¤æ¡å…¬å¼å¯ä»¥æ¨å¯¼å‡ºé€»è¾‘å›å½’çš„$$\theta$$
$$
\begin{aligned}
\theta:=\theta- \alpha X^T(\frac{1}{1+e^{-X \theta}}-Y)
\end{aligned}
$$

**æŸ¥å…¨ç‡ä¸æŸ¥å‡†ç‡ï¼š**

ç”±äºé€»è¾‘å›å½’æ˜¯åˆ†ç±»ä»»åŠ¡ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬ç”¨æŸ¥å…¨ç‡å’ŒæŸ¥å‡†ç‡ä½œä¸ºæ¨¡å‹çš„è¡¡é‡æŒ‡æ ‡

| çœŸå®æƒ…å†µ |    é¢„æµ‹    |    ç»“æœ    |
| :------- | :--------: | :--------: |
|          |    æ­£ä¾‹    |    åä¾‹    |
| æ­£ä¾‹     | TP(çœŸæ­£ä¾‹) | FN(å‡åä¾‹) |
| åä¾‹     | FP(å‡æ­£ä¾‹) | TN(çœŸåä¾‹) |

æŸ¥å‡†ç‡ï¼ˆ$$P$$ï¼‰ï¼š$$P=\frac{TP}{TP+FP}$$

æŸ¥å…¨ç‡ï¼ˆ$$R$$ï¼‰:$$R=\frac{TP}{TP+FN}$$

#### ä»£ç å®ç°ï¼š

**è¿‡ç¨‹ï¼š**è®¾ç½®å­¦ä¹ ç‡ï¼ˆè¿™é‡Œè®¾ä¸º0.01ï¼Œå¦åˆ™é¢„æµ‹å€¼ä¼šå¾ˆå¤§ï¼‰å’Œè®­ç»ƒæ¬¡æ•°--æ±‚sigmoidå‡½æ•°åˆ—å‘é‡å¹¶ä»¥ä¹‹æ¥æ±‚Î¸--æ¯ä¸€è½®éƒ½ç”¨Î¸æ±‚ä¼°è®¡å€¼--ç”¨æœ€åä¸€ç»„ä¼°è®¡å€¼æ¥æ±‚æŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡

[é€»è¾‘å›å½’pythonå®ç°](https://blog.csdn.net/qq_37667364/article/details/81532339?ops_request_misc=&request_id=&biz_id=102&utm_term=é€»è¾‘å›å½’python&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-81532339.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187)

[é€»è¾‘å›å½’æ¨¡å‹ï¼ˆLogistic Regressionï¼‰åŠPythonå®ç°](https://blog.csdn.net/wang603603/article/details/81334218?ops_request_misc=&request_id=&biz_id=102&utm_term=é€»è¾‘å›å½’python&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-81334218.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187)

å°†$$\frac{1}{1+e^{-X \theta}}$$å˜ä¸ºåˆ—å‘é‡ï¼Œ$$\frac{1}{1+e^{-\theta^T x^{(i)}}}$$ä¾¿æ˜¯å…¶ä¸­çš„å…ƒç´ ï¼š

```python
def get_sigmoid_matrix():
    sigmoid_matrix = []
    for i in range(len(X)):
        sigmoid_matrix.append(1+math.exp((-X*theta)[i]))
    return np.mat(sigmoid_matrix).T
```

æ±‚Î¸çš„å‡½æ•°ï¼š

```python
def get_theta(X, Y, theta, alpha):
    theta = theta-alpha*X.T*(get_sigmoid_matrix(theta)-Y)
    return theta
```

æ±‚ä¼°è®¡å€¼ï¼Œå¹¶ç”Ÿæˆåˆ—å‘é‡ï¼ˆè§„å®š>=0.5ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼‰ï¼š

```python
def get_predict(theta):
    pre_matrix = get_sigmoid_matrix(theta)
    for i in range(m):
        if pre_matrix[i] < 0.5:
            pre_matrix[i] = 0
        else:
            pre_matrix[i] = 1
    return pre_matrix
```

æ±‚æŸ¥å…¨ç‡å’ŒæŸ¥å‡†ç‡ï¼š

```python
def precision_and_recall_rate(Y_pre, Y):
    TP = 0 #çœŸæ­£ä¾‹
    FN = 0 #å‡åä¾‹
    FP = 0 #å‡æ­£ä¾‹
    TN = 0 #çœŸåä¾‹
    for i in range(m):
        if Y_pre[i] == 1 and Y[i] == 1:
            TP += 1
        if Y_pre[i] == 1 and Y[i] == 0:
            FP += 1
        if Y_pre[i] == 0 and Y[i] == 1:
            FN += 1
        if Y_pre[i] == 0 and Y[i] == 0:
            TN += 1
    precision_rate = TP/(TP+FP)
    recall_rate = TP/(TP+FN)
    return precision_rate, recall_rate
```

å…¨éƒ¨ä»£ç ï¼š

```python
import math
import numpy as np
from sklearn import datasets
# å¯¼å…¥ç•™ä¸€æ³•å‡½æ•°
data = datasets.load_diabetes()
# å¯¼å…¥ç³–å°¿ç—…æ•°æ®é›†

X = data.data
X = np.hstack((np.ones((len(X), 1)), X))
X = np.mat(X)
# è¿™é‡Œä¸ç”¨è½¬ç½®

Y = data.target
Y = np.mat(Y).T
# ç”±äºè¯¥æ•°æ®é›†å¹¶ä¸é€‚åˆç”¨äºé€»è¾‘å›å½’ï¼Œå› æ­¤å°±æ ¹æ®æ ‡ç­¾çš„å–å€¼èŒƒå›´éšä¾¿è®¾äº†ä¸€ä¸ªæŒ‡æ ‡
for i in range(len(X)):
    if Y[i] < 150:
        Y[i] = 0
    else:
        Y[i] = 1


theta = np.zeros(11)
theta = np.mat(theta).T
alpha = 0.01
times = 5000
m = len(X)


def get_sigmoid_matrix(theta):
    sigmoid_matrix = []
    for i in range(m):
        sigmoid_matrix.append(1/(1+math.exp(np.array(-(X*theta)[i]))))
    return np.mat(sigmoid_matrix).T


def get_theta(X, Y, theta, alpha):
    theta = theta-alpha*X.T*(get_sigmoid_matrix(theta)-Y)
    return theta


def get_predict(theta):
    pre_matrix = get_sigmoid_matrix(theta)
    for i in range(m):
        if pre_matrix[i] < 0.5:
            pre_matrix[i] = 0
        else:
            pre_matrix[i] = 1
    return pre_matrix


def precision_and_recall_rate(Y_pre, Y):
    TP = 0 #çœŸæ­£ä¾‹
    FN = 0 #å‡åä¾‹
    FP = 0 #å‡æ­£ä¾‹
    TN = 0 #çœŸåä¾‹
    for i in range(m):
        if Y_pre[i] == 1 and Y[i] == 1:
            TP += 1
        if Y_pre[i] == 1 and Y[i] == 0:
            FP += 1
        if Y_pre[i] == 0 and Y[i] == 1:
            FN += 1
        if Y_pre[i] == 0 and Y[i] == 0:
            TN += 1
    precision_rate = TP/(TP+FP)
    recall_rate = TP/(TP+FN)
    return precision_rate, recall_rate


for i in range(500):
    theta = get_theta(X, Y, theta, alpha)
    pre_matrix = get_predict(theta)


print(pre_matrix)
precision_rate, recall_rate = precision_and_recall_rate(pre_matrix, Y)
print(precision_rate)
print(recall_rate)
```

æœ€ç»ˆç»“æœï¼š

æŸ¥å…¨ç‡(Recall rate)ï¼š0.71568

æŸ¥å‡†ç‡(precision_rate)ï¼š0.73

## å†³ç­–æ ‘

### åŸºæœ¬æ¦‚å¿µ

å†³ç­–æ ‘æœ‰æ—¶æŒ‡ä¸€ç§æœºå™¨å­¦ä¹ æ–¹æ³•ï¼ˆä»¥äºŒåˆ†ç±»ä»»åŠ¡ä¸ºä¾‹ï¼Œåˆ¤å®šæˆ–å†³ç­–å½“å‰æ ·æœ¬æ˜¯å¦å±äºæ­£ç±»ï¼‰ï¼Œæœ‰æ—¶æŒ‡å­¦å¾—çš„æ ‘ã€‚

å†³ç­–æ ‘çš„ç»„æˆï¼šä¸€ä¸ªæ ¹ç»“ç‚¹ã€è‹¥å¹²ä¸ªå†…éƒ¨ç»“ç‚¹å’Œè‹¥å¹²ä¸ªå¶ç»“ç‚¹ã€‚

æ ¹ç»“ç‚¹åŒ…å«æ ·æœ¬å…¨é›†ã€‚

å¶ç»“ç‚¹å¯¹åº”äºå†³ç­–çš„ç»“æœï¼Œéå¶ç»“ç‚¹çš„å…¶å®ƒç»“ç‚¹å¯¹åº”äºä¸€ä¸ªå±æ€§æµ‹è¯•ã€‚

*ï¼ˆå†…éƒ¨ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾æˆ–å±æ€§ï¼Œå¶ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç±»ã€‚å›¾è¯¦è§ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹P68ï¼‰*

å¦‚å›¾ä¸éš¾çœ‹å‡ºï¼Œå†³ç­–æ ‘çš„ç”Ÿæˆæ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œå³å½“æ— æ³•å†åˆ’åˆ†å‡ºæ–°çš„ç»“ç‚¹æ—¶å°±ä¼šè¿”å›ã€‚

**è¿”å›çš„ä¸‰ç§æƒ…å†µï¼š**

1. å½“å‰ç»“ç‚¹åŒ…å«çš„æ ·æœ¬å…¨å±äºåŒä¸€ç±»åˆ«ï¼Œæ— éœ€åˆ’åˆ†

2. å½“å‰å±æ€§é›†ä¸ºç©ºï¼Œæˆ–æ˜¯æ‰€æœ‰æ ·æœ¬åœ¨æ‰€æœ‰å±æ€§ä¸Šå–å€¼ç›¸åŒï¼Œæ— æ³•åˆ’åˆ†ï¼ˆäºæ˜¯æˆ‘ä»¬æŠŠå½“å‰ç»“ç‚¹æ ‡è®°ä¸ºå¶ç»“ç‚¹ï¼Œå¹¶å°†å…¶ç±»åˆ«è®¾å®šä¸ºè¯¥ç»“ç‚¹æ‰€å«æ ·æœ¬æœ€å¤šçš„ç±»åˆ«ï¼‰

3. å½“å‰ç»“ç‚¹åŒ…å«çš„æ ·æœ¬é›†ä¸ºç©ºï¼Œä¸èƒ½åˆ’åˆ†ï¼ˆäºæ˜¯æˆ‘ä»¬æŠŠå½“å‰ç»“ç‚¹æ ‡è®°ä¸ºå¶ç»“ç‚¹ï¼Œå¹¶å°†å…¶ç±»åˆ«è®¾å®šä¸ºå…¶çˆ¶ç»“ç‚¹æ‰€å«æ ·æœ¬æœ€å¤šçš„ç±»åˆ«ï¼‰

*æ³¨æ„ï¼šæƒ…å½¢2æ˜¯åœ¨åˆ©ç”¨å½“å‰ç»“ç‚¹çš„åéªŒåˆ†å¸ƒï¼Œè€Œæƒ…å½¢3åˆ™æ˜¯æŠŠçˆ¶ç»“ç‚¹çš„æ ·æœ¬åˆ†å¸ƒä½œä¸ºå½“å‰ç»“ç‚¹çš„å…ˆéªŒåˆ†å¸ƒ*

**æœ€ä¼˜åˆ’åˆ†å±æ€§ï¼š**åœ¨åˆ’åˆ†çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å±æ€§é›†ä¸­æ‰¾åˆ°ä¸€ä¸ªå±æ€§ä½¿å¾—å†³ç­–æ ‘çš„åˆ†æ”¯ç»“ç‚¹æ‰€åŒ…å«çš„æ ·æœ¬å°½å¯èƒ½å±äºåŒä¸€ç±»åˆ«ï¼ˆå³ç»“ç‚¹çš„çº¯åº¦è¶Šæ¥è¶Šé«˜ï¼‰

### åŸºæœ¬æ­¥éª¤åŠä¸‰ç§ç®—æ³•

åŸºæœ¬æ­¥éª¤ï¼šç‰¹å¾é€‰æ‹©ã€å†³ç­–æ ‘çš„ç”Ÿæˆï¼ˆè€ƒè™‘å±€éƒ¨æœ€ä¼˜ï¼‰å’Œå†³ç­–æ ‘çš„ä¿®å‰ªï¼ˆè€ƒè™‘å…¨å±€æœ€ä¼˜ï¼‰

ä¸‰ç§ç®—æ³•ï¼š**ID3ç®—æ³•**ã€**C4.5ç®—æ³•**å’Œ**CARTç®—æ³•**

#### ç‰¹å¾é€‰æ‹©

å«ä¹‰ï¼šå†³å®šç”¨å“ªä¸ªç‰¹å¾æ¥åˆ’åˆ†ç‰¹å¾ç©ºé—´

ä¸¤ç§å‡†åˆ™ï¼šä¿¡æ¯å¢ç›Šå’Œä¿¡æ¯å¢ç›Šæ¯”

##### ä¿¡æ¯å¢ç›Š

[ä¿¡æ¯å¢ç›Šåˆ°åº•æ€ä¹ˆç†è§£å‘¢ï¼Ÿ](https://www.zhihu.com/question/22104055/answer/161415527)

**ä¿¡æ¯ç†µï¼š**

**å«ä¹‰ï¼š**è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ã€‚ï¼ˆç†µè¶Šé«˜ï¼Œä¸ç¡®å®šæ€§è¶Šå¤§ï¼Œä¿¡æ¯é‡è¶Šå¤§ï¼‰

è®¾$$X$$æ˜¯ä¸€ä¸ªå–æœ‰é™ä¸ªå€¼çš„ç¦»æ•£éšæœºå˜é‡ï¼Œå…¶æ¦‚ç‡åˆ†å¸ƒä¸º$$P(X=x_i)=p_i,\ i=1,2,\cdots,n$$

åˆ™$$X$$çš„ç†µå®šä¹‰ä¸º$$H(X)=-\sum \limits_{i=1}^n p_i log\ p_i$$ï¼Œè§„å®š$$0log0$$ä¸º$$0$$

å½“å¯¹æ•°ä»¥$$2$$æˆ–$$e$$ä¸ºåº•æ—¶ï¼Œè¿™æ—¶ç†µçš„å•ä½åˆ†åˆ«è¢«ç§°ä¸º*æ¯”ç‰¹*æˆ–*çº³ç‰¹*ï¼ˆå½“$$X$$åªå–0ï¼Œ1æ—¶ï¼Œä»¥2ä¸ºåº•ï¼‰

* æ¡ä»¶ç†µ

  è®¾æœ‰éšæœºå˜é‡$$Y$$ï¼Œå…¶ä¸$$X$$è”åˆæ¦‚ç‡åˆ†å¸ƒä¸º$$P(X=x_i,Y=y_i)=p_{ij},\ i=1,2,\cdots,n;\ j=1,2,\cdots,m$$

  æ¡ä»¶ç†µå®šä¹‰ä¸º$$X$$ç»™å®šæ¡ä»¶ä¸‹$$Y$$çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„ç†µå¯¹$$X$$çš„æ•°å­¦æœŸæœ›ï¼š

  $$H(Y|X)=\sum \limits_{i=1}^n p_iH(Y|X=x_i)$$ï¼Œå…¶ä¸­$$p_i=P(X=x_i)$$

  *(ç”¨æœ€ç®€å•çš„ç†è§£ï¼Œå³æŠŠ$$Y$$çœ‹æˆæ­£åç±»çš„é›†åˆï¼Œé‚£ä¹ˆ$$H(Y|X=x_i)=-\sum\limits_{k=1}^2 p_{(x_i,Y_k)}log\ p_{(x_i,Y_k)}$$ï¼Œå³åªä¸ç±»çš„æ•°ç›®æœ‰å…³)*

* ç»éªŒç†µä¸ç»éªŒæ¡ä»¶ç†µ

  å½“ç†µå’Œæ¡ä»¶ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡ï¼ˆç‰¹åˆ«æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ï¼‰å¾—åˆ°æ—¶å¯¹åº”çš„ç†µå’Œæ¡ä»¶ç†µ

**äº’ä¿¡æ¯ï¼š**ç†µä¸æ¡ä»¶ç†µä¹‹å·®

é’ˆå¯¹ä¸åŒçš„ç‰¹å¾ï¼Œä¸€ä¸ªæ•°æ®é›†å¯äº§ç”Ÿå¤šä¸ªä¿¡æ¯å¢ç›Šï¼ˆå³å¤šä¸ªäº’ä¿¡æ¯ï¼‰ï¼Œè¡¨ç¤ºç‰¹å®šç‰¹å¾å¯¹æ•°æ®é›†åˆ†ç±»çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚å› æ­¤ï¼Œä¿¡æ¯å¢ç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›ã€‚

è®¾æ•°æ®é›†$$D$$æœ‰$$K$$ä¸ªç±»ï¼ˆå¦‚æ­£åç±»ï¼‰$$C_k,k=1,2,\cdots,K$$ï¼Œç‰¹å¾$$A$$æœ‰$$n$$ä¸ªä¸åŒçš„å–å€¼ï¼Œå…¶å°†$$D$$åˆ†æˆ$$n$$ä¸ªä¸åŒçš„å­é›†ã€‚ç”¨$$|D|$$è¡¨ç¤ºè¯¥æ•°æ®é›†çš„å®¹é‡ï¼ˆæ ·æœ¬æ•°ï¼‰ï¼Œ$$|C_k|$$è¡¨ç¤º$$k$$ç±»æ‰€å«çš„æ ·æœ¬æ•°ï¼Œ$$|D_i|,i=1,2,\cdots,n$$è¡¨ç¤ºç”¨ç‰¹å¾$$A$$åˆ†æˆçš„å­é›†$$D_i$$æ‰€å«çš„æ ·æœ¬æ•°ã€‚è®°å­é›†$$D_i$$ä¸­å±äº$$C_k$$çš„æ ·æœ¬é›†åˆä¸º$$D_{ik}$$ã€‚

åˆ™$$H(D)=-\sum \limits_{k=1}^K \frac{|C_k|}{|D|}log_2\ \frac{|C_k|}{|D|}$$

$$H(D|A)=\sum\limits_{i=1}^n \frac{|D_i|}{|D|}H(D_i)=-\sum\limits_{i=1}^n \frac{|D_i|}{|D|}(\sum\limits_{k=1}^K \frac{|D_{ik}|}{|D_i|}log_2\ \frac{|D_{ik}|}{|D_i|})$$

åˆ™ç‰¹å¾$$A$$å¯¹æ•°æ®é›†$$D$$çš„ä¿¡æ¯å¢ç›Šä¸º

$$g(D,A)=H(D)-H(D|A)$$

##### ä¿¡æ¯å¢ç›Šæ¯”

ä¿¡æ¯å¢ç›Šå­˜åœ¨åå‘äºé€‰æ‹©å€¼è¾ƒå¤šçš„ç‰¹å¾ä¹‹é—®é¢˜ï¼Œä¿¡æ¯å¢ç›Šæ¯”èƒ½å¯¹è¯¥é—®é¢˜è¿›è¡ŒçŸ«æ­£

$$g_R(D,A)=\frac{g(D,A)}{H_A(D)}$$

å…¶ä¸­$$H_A(D)=-\sum\limits_{i=1}^n \frac{|D_i|}{|D|}log_2\frac{|D_i|}{|D|}$$ï¼Œæ„ä¸ºè®­ç»ƒé›†$$D$$å…³äºç‰¹å¾$$A$$çš„å€¼çš„ç†µ

#### ID3ç®—æ³•

ç‰¹ç‚¹ï¼šåœ¨åˆ†ç»“ç‚¹çš„è¿‡ç¨‹ä¸­ä¸æ–­é€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾

##### ä»£ç å®ç°

[pythonå®ç°ID3å†³ç­–æ ‘åˆ†ç±»ç®—æ³•](https://blog.csdn.net/colourful_sky/article/details/82056125?ops_request_misc=%7B%22request%5Fid%22%3A%22164421959316780271597530%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164421959316780271597530&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-82056125.first_rank_v2_pc_rank_v29&utm_term=id3ç®—æ³•pythonå®ç°&spm=1018.2226.3001.4187)

[ID3å†³ç­–æ ‘ä¸­è¿ç»­å€¼çš„å¤„ç†](https://blog.csdn.net/Leafage_M/article/details/80137305?ops_request_misc=%7B%22request%5Fid%22%3A%22164474507316780261959620%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=164474507316780261959620&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-80137305.first_rank_v2_pc_rank_v29&utm_term=å†³ç­–æ ‘è¿ç»­å€¼å¤„ç†&spm=1018.2226.3001.4187)

* è§„å®šï¼š
  * æ¯ä¸ªä¼ è¿›å‡½æ•°çš„DataFrameæˆ–åˆ—è¡¨ä¸€å®šè¦å…ˆæ’åºå¥½
  * DataFrameçš„åˆ—ç´¢å¼•ç”¨æ•°å­—è¡¨ç¤º
  * åœ¨ä¸ç”»å›¾çš„æƒ…å†µä¸‹ï¼Œå†³ç­–æ ‘ç”¨å­—å…¸çš„åµŒå¥—å‘ˆç°

**å¯¼å…¥ä¿¡æ¯**

æŠ¥é”™ï¼š*â€œUnicodeDecodeError: 'utf-8' codec can't decode byte 0xb1 in position 0: invalid start byteâ€*

åŸå› ï¼šæ–‡æœ¬ä¸­å«æœ‰æ±‰å­—ï¼Œæ±‰å­—çš„ç¼–ç æ ¼å¼æ˜¯â€œgbkâ€ã€â€œgb2312â€æˆ–â€œgb18030â€ï¼Œå› æ­¤è¦åœ¨å¯¼å…¥æ—¶æ”¹å˜ç¼–ç æ ¼å¼

```python
import math
import pandas as pd
data = pd.read_csv("melon.txt", encoding='gbk')  # æ ¼å¼ä¸ºDataFrame
```

**ä¿¡æ¯å¤„ç†**

```python
del data['ç¼–å·']
del data['å«ç³–ç‡']
del data['å¯†åº¦']
feature_name = data.columns.tolist()  # æå–åˆ—ç´¢å¼•ä½œä¸ºç‰¹å¾é›†
del feature_name[-1]  # åˆ æ‰ç±»åˆ«åˆ—
column_number = data.shape[1]  # è·å–åˆ—æ•°
data.columns = range(column_number)  # é‡è®¾åˆ—ç´¢å¼•ä¸ºæ•°å­—å½¢å¼
```

**è®¡ç®—ç†µçš„å‡½æ•°**

```python
def get_entropy(number, category, data_set):
    """
    :param number: ç±»çš„ç§ç±»ä¸ªæ•°
    :param category: åŒ…å«å„ç±»ç§ç±»æˆ–ç‰¹å¾å„å–å€¼ç§ç±»ä¸ªæ•°çš„åˆ—è¡¨
    :param data_set: æ•°æ®é›†
    :return: æ•°æ®é›†çš„ç†µ
    """
    entropy = 0
    for i in range(number):
        entropy += category[i]/len(data_set)*math.log(category[i]/len(data_set), 2)
    return -entropy
```

**å°†ç‰¹å¾åˆ†ç±»ï¼Œå¹¶æå–æŒ‡å®šçš„$$D_{ik}$$**

```python
def classify_category(feature, i):
    """
    :param feature: åŒ…å«è¯¥ç‰¹å¾çš„å„å–å€¼ç§ç±»çš„DataFrameï¼ˆå«æœ‰å¯¹åº”çš„ç±»ï¼‰
    :param i:è¦ç¬¬iä¸ªå–å€¼çš„ä¿¡æ¯
    :return: Diæ‰€å«æ ·æœ¬æ•°å’ŒDikçš„æ ·æœ¬æ•°åˆ—è¡¨ï¼ˆDikä¸ºè¯¥ç‰¹å¾çš„ç¬¬iä¸ªå–å€¼çš„é›†åˆä¸ç¬¬kä¸ªç±»çš„äº¤é›†ï¼‰
    """
    feature_name_i = list(feature.groupby([0]).groups.keys())[i]  # æŠŠç¬¬iä¸ªå–å€¼çš„åå­—æˆ–æ•°å€¼æå–å‡ºæ¥
    data_feature_name_i = feature[feature[0] == feature_name_i]  # æŠŠå«æœ‰ç¬¬iä¸ªå–å€¼çš„è¡Œæå–å‡ºæ¥
    number_feature_category = data_feature_name_i.iloc[:, -1].value_counts()  # Dikçš„æ ·æœ¬æ•°åˆ—è¡¨
    return number_feature_category
```

**è®¡ç®—æ¡ä»¶ç†µçš„å‡½æ•°**

[pythonä¸­ç»Ÿè®¡åˆ—è¡¨å„ä¸ªå…ƒç´ çš„ä¸ªæ•°](https://blog.csdn.net/weixin_30602505/article/details/98010252?ops_request_misc=&request_id=&biz_id=102&utm_term=ç»Ÿè®¡åˆ—è¡¨ä¸åŒå…ƒç´ ä¸ªæ•°&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-98010252.first_rank_v2_pc_rank_v29&spm=1018.2226.3001.4187)

ç»†èŠ‚ï¼šç”±äº`value_counts()`ä¸`groupby()`å’Œ`sort_values()`çš„æ’åºæ–¹æ³•ä¸åŒï¼Œä¸”è¿™é‡Œçš„å‡½æ•°å¤§å¤šç”¨åä¸¤è€…ï¼Œæ‰€ä»¥è¿™é‡Œæ±‚â€œç‰¹å¾å„ç§ç±»æ‰€å«çš„æ ·æœ¬æ•°â€ï¼Œå³$$|D_i|$$çš„æ—¶å€™ç”¨è‡ªå·±å†™çš„æ–¹æ³•ã€‚

```python
def get_conditional_entropy(feature, data_set):
    """
    :param feature: åŒ…å«è¯¥ç‰¹å¾çš„å„å–å€¼ç§ç±»çš„DataFrameï¼ˆå«æœ‰å¯¹åº”çš„ç±»ï¼‰
    :param data_set: æ€»æ•°æ®é›†
    :return: æŸä¸ªç‰¹å¾çš„æ¡ä»¶ç†µ
    """
    conditional_entropy = 0
    category_number_feature = []  # ç‰¹å¾å„ç§ç±»æ‰€å«çš„æ ·æœ¬æ•°
    values = []  # ç”¨äºæŸ¥é‡
    for value in list(feature[0]):
        if value not in values:
            values.append(value)
            category_number_feature.append(list(feature[0]).count(value))
    number_feature = len(list(feature.groupby([0]).groups.keys()))  # ç‰¹å¾çš„å–å€¼ç§ç±»æ•°ç›®
    for i in range(number_feature):
        number_feature_category, data_i = classify_category(feature, i)  # Dikçš„æ ·æœ¬æ•°åˆ—è¡¨å’ŒDi(DataFrameæ ¼å¼)
        factor = category_number_feature[i]/len(data_set)  # å¼å­å¤ªé•¿ï¼Œå› å­æ‹†å¼€å†™
        conditional_entropy += factor*get_entropy(len(number_feature_category), number_feature_category, data_i)
    return conditional_entropy
```

**é€‰æ‹©æœ€å¤§ä¿¡æ¯å¢ç›Šçš„å‡½æ•°**

```python
def get_max_information_gain(data_information_gain):
    """
    :param data_information_gain: åŒ…å«å¤šä¸ªä¿¡æ¯å¢ç›Šçš„åˆ—è¡¨
    :return: æœ€å¤§ä¿¡æ¯å¢ç›ŠåŠå…¶æ‰€å¯¹åº”çš„ç‰¹å¾æ‰€åœ¨çš„åˆ—çš„ç¼–å·
    """
    max_information_gain = 0
    number_best_feature = 0
    for i in range(len(data_information_gain)):
        if data_information_gain[i] > max_information_gain:
            max_information_gain = data_information_gain[i]
            number_best_feature = i
    return max_information_gain, number_best_feature
```

**å¯»æ‰¾å«æ ·æœ¬æ•°æœ€å¤šçš„ç±»çš„å€¼**

```python
def majorityCnt(category):
    """
    :param category: ç±»åˆ«åˆ—è¡¨(æ ¼å¼è¦æ±‚ä¸ºSeries)
    :return: å«æ ·æœ¬æ•°æœ€å¤šçš„ç±»çš„å€¼
    """
    category = pd.DataFrame(category.value_counts().reset_index)  # ä½¿Seriesè½¬æ¢æˆå«æœ‰ä¸¤åˆ—çš„DataFrame(ç¬¬ä¸€åˆ—æ˜¯ç±»ï¼Œç¬¬äºŒåˆ—æ˜¯æ ·æœ¬æ•°)
    category.columns = range(2)  # è®¾ç½®åˆ—ç´¢å¼•

    list_number_category = category[1]  # æå–åŒ…å«æ ·æœ¬æ•°çš„åˆ—
    max_number = list_number_category[0]  # æ ·æœ¬æ•°æœ€å¤§çš„å€¼
    loc_max_number = 0  # æ ·æœ¬æ•°æœ€å¤§å€¼æ‰€åœ¨çš„ä½ç½®
    for i in range(len(list_number_category)):  # å¯»æ‰¾æ ·æœ¬æ•°æœ€å¤§å€¼æ‰€åœ¨çš„ä½ç½®
        if list_number_category[i] > max_number:
            max_number = list_number_category[i]
            loc_max_number = i
    return category[0][loc_max_number]
```

**åˆ’åˆ†æ•°æ®é›†**

```python
def classify_data(data_set, i, value):
    """
    :param data_set: è¦è¢«åˆ’åˆ†çš„æ•°æ®é›†
    :param i: ç‰¹å¾æ‰€åœ¨çš„åˆ—çš„ä½ç½®
    :param value: ç‰¹å¾çš„ä¸€ä¸ªå–å€¼
    :return: åˆ’åˆ†åçš„æ•°æ®é›†
    """
    new_data_set = data_set[data_set[i] == value].reset_index(drop=True)
    del new_data_set[i]
    new_data_set.columns = range(new_data_set.shape[1])  # é‡æ–°è®¾ç½®åˆ—ç´¢å¼•
    return new_data_set
```

**æ„å»ºID3å†³ç­–æ ‘**

å¤§è‡´æµç¨‹ï¼šåˆ¤æ–­ç‰¹æ®Šæƒ…å†µ--è®¡ç®—å¤šä¸ªä¿¡æ¯å¢ç›Šå¹¶æ‰¾åˆ°æœ€å¤§ä¿¡æ¯å¢ç›Šå¯¹åº”çš„ç‰¹å¾--åˆ’åˆ†å¤šä¸ªæ•°æ®é›†ï¼ŒåŒæ—¶è¿›è¡Œé€’å½’

ç»†èŠ‚ï¼šåœ¨ä¼ åˆ—è¡¨çš„æ—¶å€™è¦å…ˆå¤åˆ¶ï¼Œä¼ çš„æ˜¯å¤åˆ¶çš„åˆ—è¡¨ã€‚å› ä¸ºåˆ—è¡¨ä¸Cè¯­è¨€çš„æ•°ç»„ä¸€æ ·ï¼Œä¼ çš„æ˜¯åœ°å€ï¼Œæ˜¯ä¼šå¯¹åŸæ•°ç»„è¿›è¡Œä¿®æ”¹çš„ã€‚

```python
def tree_ID3(data_set, featureName):
    """
    :param data_set: è®­ç»ƒé›†
    :param featureName: å½“å‰æ‰€å«ç‰¹å¾åçš„åˆ—è¡¨
    :return:
    """
    category_list = list(data_set.iloc[:, -1])  # æå–ç±»åˆ«
    if category_list.count(category_list[0]) == len(category_list):
        return category_list[0]  # è®­ç»ƒé›†ä¸­æ‰€æœ‰å®ä¾‹éƒ½å±äºåŒä¸€ç±»
    if len(featureName) == 1:  # åªæœ‰ä¸€ä¸ªç‰¹å¾æ—¶è¿”å›è®­ç»ƒé›†ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»çš„å€¼
        return majorityCnt(category_list)

    num_columns = data_set.shape[1]  # è·å–åˆ—æ•°
    number_category = len(data_set.iloc[:, -1].value_counts())  # ç±»çš„ç§ç±»æ•°ç›®
    information_gain = []  # ä¿¡æ¯å¢ç›Šåˆ—è¡¨
    for i in range(data_set.shape[1]-1):  # è®¡ç®—æ¯ä¸ªç‰¹å¾çš„ä¿¡æ¯å¢ç›Š
        base_entropy = get_entropy(number_category, data_set.iloc[:, -1].value_counts(), data_set)  # ç†µ

        feature_i = data_set[[i, num_columns-1]]  # æå–ç‰¹å¾
        feature_i.sort_values(by=[i]).reset_index(drop=True)  # é‡æ–°æ’åº
        feature_i.columns = range(2)  # é‡æ–°è®¾ç½®åˆ—ç´¢å¼•

        conditional_entropy = get_conditional_entropy(feature_i, data_set)  # æ¡ä»¶ç†µ
        information_gain.append(base_entropy - conditional_entropy)
    num_best_feature = get_max_information_gain(information_gain)  # æœ€å¤§ä¿¡æ¯å¢ç›Šæ‰€å¯¹åº”çš„ç‰¹å¾æ‰€åœ¨çš„åˆ—çš„ç¼–å·
    name_best_feature = featureName[num_best_feature]  # æœ€å¤§ä¿¡æ¯å¢ç›Šæ‰€å¯¹åº”çš„ç‰¹å¾çš„åå­—
    del featureName[num_best_feature]

    tree = {name_best_feature: {}}  # å­—å…¸çš„åµŒå¥—ä½¿ç”¨

    target_feature = data_set[num_best_feature]  # æå–ç›®æ ‡ç‰¹å¾åºåˆ—
    kind_target_feature = set(target_feature)  # æŠŠç›®æ ‡ç‰¹å¾åºåˆ—çš„ä¸åŒå–å€¼æå–å‡ºæ¥ï¼Œå½¢æˆé›†åˆ
    for value in kind_target_feature:  # å¼€å§‹åˆ’åˆ†æ•°æ®é›†å¹¶è¿›è¡Œé€’å½’
        data_set_new = classify_data(data_set, num_best_feature, value)
        substitute_featureName = featureName[:]  # å¤åˆ¶æ“ä½œ
        tree[name_best_feature][value] = tree_ID3(data_set_new, substitute_featureName)
    return tree
```

**è°ƒç”¨**

```python
my_tree = tree_ID3(data, feature_name)
print(my_tree)
```

**ç»“æœ**

`{'çº¹ç†': {'æ¨¡ç³Š': 'å¦', 'æ¸…æ™°': {'è„éƒ¨': {'å‡¹é™·': 'æ˜¯', 'å¹³å¦': 'å¦', 'ç¨å‡¹': {'è‰²æ³½': {'é’ç»¿': 'æ˜¯', 'ä¹Œé»‘': {'è§¦æ„Ÿ': {'ç¡¬æ»‘': 'æ˜¯', 'è½¯ç²˜': 'å¦'}}}}}}, 'ç¨ç³Š': {'è§¦æ„Ÿ': {'ç¡¬æ»‘': 'å¦', 'è½¯ç²˜': 'æ˜¯'}}}}`

**æ€»ç»“**

æœ€èŠ±æ—¶é—´çš„åè€Œæ˜¯ä»£ç çš„å®ç°éƒ¨åˆ†ï¼Œå›°éš¾ä¸»è¦ä½“ç°åœ¨ï¼šä¸çŸ¥é“å¦‚ä½•æ„é€ å‡½æ•°ã€è¦æ„é€ ä»€ä¹ˆå‡½æ•°ã€å‡½æ•°çš„æ¥å£æ€ä¹ˆæ‰èƒ½è®¾ç½®åˆç†ã€å¦‚ä½•åˆ’åˆ†æ•°æ®é›†ï¼Œä»¥åŠå†³ç­–æ ‘æ€ä¹ˆå‘ˆç°ã€‚è§£å†³çš„è¿‡ç¨‹ï¼šé€šè¿‡çœ‹åšå®¢å’Œæ‹†åˆ†æ•°å­¦å…¬å¼ï¼ˆæœ€é‡è¦çš„æ˜¯æ‰¾ç›¸åŒç‚¹ï¼‰å°±å¯ä»¥äº†è§£æ•´ä¸ªç®—æ³•çš„æ„é€ ï¼Œäºæ˜¯å°±è‡ªå·±åŠ¨æ‰‹å†™å‡½æ•°ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æœ€éš¾å—çš„æ˜¯åˆ’åˆ†æ•°æ®é›†è¿™ä¸€æ­¥ï¼Œè¿™ä¸»è¦æ˜¯ç”±äºè‡ªå·±å¯¹æ•°æ®åˆ†æå‡½æ•°çš„æŒæ¡å¤ªç”Ÿç–äº†ï¼Œæˆ‘äºæ˜¯ä¸æ–­åœ¨çº¸ä¸Šç”»å›¾æƒ³æ€è·¯ï¼Œç„¶åä¸Šåšå®¢æŸ¥æ‰¾æ–¹æ³•ï¼Œç»ˆäºæ˜¯ç†Ÿç»ƒäº†ä¸å°‘ã€‚å‡½æ•°çš„æ¥å£è®¾ç½®åº”è¯¥æå‰æƒ³å¥½ï¼ˆçŸ¥é“å¤§æ¦‚çš„æ„é€ åå°±å¯ä»¥è§„åˆ’äº†ï¼‰ï¼Œå˜é‡çš„å‘½åé—®é¢˜ç°åœ¨è¿˜ä¸èƒ½å®Œå…¨è§£å†³ï¼ˆæ„æ€ç›¸è¿‘çš„å˜é‡æœ‰ç‚¹å¤šï¼‰ã€‚æ€»ä¹‹ï¼Œæœ‰è€å¿ƒå°±è¡Œäº†ğŸ¤¡
